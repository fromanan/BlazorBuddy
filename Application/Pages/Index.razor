@page "/"

<PageTitle>Blazor Buddy</PageTitle>

@SessionService.RenderSelectedSession()

@code
{
    protected override void OnInitialized()
    {
        SubscribeListeners();
    }

    protected override void OnAfterRender(bool firstRender)
    {
        SessionService.Initialize(ContextMenuService);
    }

    private void SubscribeListeners()
    {
        SessionService.SelectionChanged     += UpdateView;
        SessionService.SessionsUpdated      += UpdateView;
        LayoutService.LayoutStyleChanged    += UpdateView;
        LayoutService.SortOrderChanged      += UpdateView;
    }

    private async void UpdateView()
    {
        await InvokeAsync(StateHasChanged);
    }

    private async void UpdateView<T>(T obj)
    {
        await InvokeAsync(StateHasChanged);
    }
}